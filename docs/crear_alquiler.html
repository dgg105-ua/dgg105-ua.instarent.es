<!DOCTYPE html>
<html lang="es" class="no-js">
<head>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <meta charset="UTF-8">
  <!-- Mobile Specific Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Favicon-->
  <link rel="shortcut icon" href="img/fav.png">
  <!-- Author Meta -->
  <meta name="author" content="CodePixar">
  <!-- Meta Description -->
  <meta name="description" content="">
  <!-- Meta Keyword -->
  <meta name="keywords" content="">
  <!-- Site Title -->
  <title>Crear Alquiler - InstaRent</title>
  <!--
    CSS
    (Aquí reutilizamos los mismos enlaces que tienes en tu index.html para mantener el mismo estilo)
  -->
  <link rel="stylesheet" href="css/linearicons.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <link rel="stylesheet" href="css/themify-icons.css">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/owl.carousel.css">
  <link rel="stylesheet" href="css/nice-select.css">
  <link rel="stylesheet" href="css/nouislider.min.css">
  <link rel="stylesheet" href="css/ion.rangeSlider.css">
  <link rel="stylesheet" href="css/ion.rangeSlider.skinFlat.css">
  <link rel="stylesheet" href="css/magnific-popup.css">
  <link rel="stylesheet" href="css/main.css">

  <!-- Si deseas agregar tu propio CSS adicional, puedes incluirlo después de los estilos principales -->
  <!-- <link rel="stylesheet" href="styles.css"> -->
</head>

<body>
  <!-- Start Header Area -->
  <div id="header-placeholder"></div> 
  <!-- End Header Area -->

  <!-- Start Banner Area (opcional, para mantener estética) -->
  <section class="banner-area organic-breadcrumb">
    <div class="container">
      <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
        <div class="col-first">
          <h1>Crear Alquiler</h1>
          <h2 class="text-white">Publica tu propiedad fácilmente</h2>
        </div>
      </div>
    </div>
  </section>
  <!-- End Banner Area -->

  <!-- Contenido principal -->
  <div class="container py-5">
    <div class="row mb-4">
      <div class="col-12">
        <h2>Crear Alquiler</h2>
        <p>Completa el siguiente formulario para publicar un nuevo alquiler.</p>
      </div>
    </div>

    <!-- Formulario -->
    <form id="formCrearVivienda" class="row" enctype="multipart/form-data">
      <!-- Título del inmueble -->
      <div class="col-md-6 mb-3">
        <label for="nombre">Título del inmueble</label>
        <input type="text" id="nombre" name="nombre" class="form-control" required>
      </div>
    
      <!-- Descripción -->
      <div class="col-md-6 mb-3">
        <label for="descripcion">Descripción</label>
        <textarea id="descripcion" name="descripcion" rows="4" class="form-control" required></textarea>
      </div>
    
      <!-- Precio -->
      <div class="col-md-6 mb-3">
        <label for="precio">Precio (€/mes)</label>
        <input type="number" id="precio" name="precio" min="0" class="form-control" required>
      </div>
    
      <!-- Metros cuadrados -->
      <div class="col-md-6 mb-3">
        <label for="metrosCuadrados">Metros cuadrados</label>
        <input type="number" id="metrosCuadrados" name="metrosCuadrados" min="0" class="form-control">
      </div>
    
      <!-- Número de habitaciones -->
      <div class="col-md-6 mb-3">
        <label for="numHabitaciones">Número de habitaciones</label>
        <input type="number" id="numHabitaciones" name="numHabitaciones" min="0" class="form-control" required>
      </div>
    
      <!-- Número de baños -->
      <div class="col-md-6 mb-3">
        <label for="numBanyos">Número de baños</label>
        <input type="number" id="numBanyos" name="numBanyos" min="0" class="form-control" required>
      </div>
    
      <!-- Dirección -->
      <div class="col-md-6 mb-3">
        <label for="tipo_calle">Tipo de vía</label>
        <select id="tipo_calle" name="tipo_calle" class="form-control">
          <option value="Calle">Calle</option>
          <option value="Avenida">Avenida</option>
          <option value="Plaza">Plaza</option>
          <option value="Camino">Camino</option>
        </select>
      </div>
    
      <div class="col-md-6 mb-3">
        <label for="linea1">Dirección línea 1</label>
        <input type="text" id="linea1" name="linea1" class="form-control" required>
      </div>
    
      <div class="col-md-6 mb-3">
        <label for="linea2">Dirección línea 2 (opcional)</label>
        <input type="text" id="linea2" name="linea2" class="form-control">
      </div>
    
      <div class="col-md-3 mb-3">
        <label for="codpos">Código postal</label>
        <input type="text" id="codpos" name="codpos" class="form-control" required>
      </div>
    
      <div class="col-md-3 mb-3">
        <label for="ciudad">Ciudad</label>
        <input type="text" id="ciudad" name="ciudad" class="form-control" required>
      </div>
    
      <div class="col-md-6 mb-3">
        <label for="provincia">Provincia</label>
        <input type="text" id="provincia" name="provincia" class="form-control" required>
      </div>
    
      <!-- Botón de publicar -->
      <div class="col-12 text-center">
        <button type="submit" class="primary-btn">Publicar Alquiler</button>
      </div>
    </form>
  </div>
  <!-- Fin contenido principal -->

  <!-- start footer Area -->
  <footer class="footer-area section_gap">
    <div class="container">
      <!-- Aquí mantenemos el footer existente, pero añadimos los enlaces solicitados -->
      <div class="row">
        <div class="col-lg-3  col-md-6 col-sm-6">
          <div class="single-footer-widget">
            <h6>Sobre Nosotros</h6>
            <p>
                En InstaRent, queremos que encontrar tu próxima vivienda sea rápido, sencillo y seguro.
                ¡Bienvenido a la manera más fácil de alquilar!
            </p>
          </div>
        </div>
        <div class="col-lg-2 col-md-6 col-sm-6 ml-auto">
          <div class="single-footer-widget">
            <h6>Síguenos</h6>
            <p>Seamos sociales</p>
            <div class="footer-social d-flex align-items-center">
              <a href="#"><i class="fa fa-facebook"></i></a>
              <a href="#"><i class="fa fa-twitter"></i></a>
              <a href="#"><i class="fa fa-dribbble"></i></a>
              <a href="#"><i class="fa fa-behance"></i></a>
            </div>
          </div>
        </div>        
      </div>

      <!-- Cambio 3: Añadir Condiciones de uso, Política de privacidad, etc. -->
      <div class="footer-bottom d-flex justify-content-center align-items-center flex-wrap">
        <p class="footer-text m-0">
          <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
          <!-- Tu texto base existente -->
          <span>© 2025 InstaRent</span> |
          <a href="condiciones_uso.html">Condiciones de Uso</a> |
          <a href="politica_privacidad.html">Política de Privacidad</a> |
          <a href="politica_cookies.html">Política de Cookies</a> |
          <a href="politica_copyright.html">Política de Copyright</a>
        </p>
      </div>
    </div>
  </footer>
  <!-- End footer Area -->

  <!-- Scripts (igual que en index.html) -->
  <script src="js/vendor/jquery-2.2.4.min.js"></script>
  <script 
    src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" 
    integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" 
    crossorigin="anonymous">
  </script>
  <script src="js/vendor/bootstrap.min.js"></script>
  <script src="js/jquery.ajaxchimp.min.js"></script>
  <script src="js/jquery.nice-select.min.js"></script>
  <script src="js/jquery.sticky.js"></script>
  <script src="js/nouislider.min.js"></script>
  <script src="js/countdown.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <!--gmaps Js (si no lo usas, puedes quitarlo)-->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
  <script src="js/gmaps.min.js"></script>
  <script src="js/main.js"></script>
  <script>
    document.getElementById('formCrearVivienda').addEventListener('submit', async function (e) {
  e.preventDefault();

  const formData = new FormData(this);

  const viviendaData = {
    nombre: formData.get('nombre'),
    descripcion: formData.get('descripcion'),
    precio: parseFloat(formData.get('precio')),
    metrosCuadrados: parseFloat(formData.get('metrosCuadrados')),
    numHabitaciones: parseInt(formData.get('numHabitaciones'), 10),
    numBanyos: parseInt(formData.get('numBanyos'), 10),
    tipo_calle: formData.get('tipo_calle'),
    linea1: formData.get('linea1'),
    linea2: formData.get('linea2'),
    codpos: formData.get('codpos'),
    ciudad: formData.get('ciudad'),
    provincia: formData.get('provincia'),
    imagen: formData.get('imagen'),
  };

  try {
    const response = await fetch('http://instarent-backend.onrender.com/api/viviendas', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(viviendaData),
    });

    const data = await response.json();

    if (response.ok) {
      alert('Vivienda registrada con éxito');
      window.location.href = "index.html";
    } else {
      alert(data.error || "Error desconocido al registrar la vivienda.");
    }
  } catch (error) {
    console.error("Error al conectar con el servidor:", error);
    alert("Error al registrar la vivienda.");
  }
});
  </script>
  <script src="../scripts/header_loader.js"></script>
</body>
</html>
